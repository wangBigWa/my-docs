<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Selenium node.js中文文档 | 我是王大娃</title>
    <meta name="description" content="我是王大娃">
    <meta name="generator" content="VuePress 1.4.0">
    <meta name="theme-color" content="#3eaf7c">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
    
    <link rel="preload" href="/my-docs/assets/css/0.styles.0609bc7a.css" as="style"><link rel="preload" href="/my-docs/assets/js/app.3d81e2fe.js" as="script"><link rel="preload" href="/my-docs/assets/js/2.c5daa531.js" as="script"><link rel="preload" href="/my-docs/assets/js/11.9e365dcc.js" as="script"><link rel="prefetch" href="/my-docs/assets/js/10.b3e21764.js"><link rel="prefetch" href="/my-docs/assets/js/12.8954172e.js"><link rel="prefetch" href="/my-docs/assets/js/3.369ae110.js"><link rel="prefetch" href="/my-docs/assets/js/4.22757aa8.js"><link rel="prefetch" href="/my-docs/assets/js/5.9a9cbba2.js"><link rel="prefetch" href="/my-docs/assets/js/6.ae721f52.js"><link rel="prefetch" href="/my-docs/assets/js/7.0943a57c.js"><link rel="prefetch" href="/my-docs/assets/js/8.8acd400d.js"><link rel="prefetch" href="/my-docs/assets/js/9.81ef39c9.js">
    <link rel="stylesheet" href="/my-docs/assets/css/0.styles.0609bc7a.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/my-docs/" class="home-link router-link-active"><!----> <span class="site-name">我是王大娃</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/my-docs/document/" class="nav-link router-link-active">
  我的文档
</a></div><div class="nav-item"><a href="https://v1.vuepress.vuejs.org" target="_blank" rel="noopener noreferrer" class="nav-link external">
  我的博客
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/my-docs/document/" class="nav-link router-link-active">
  我的文档
</a></div><div class="nav-item"><a href="https://v1.vuepress.vuejs.org" target="_blank" rel="noopener noreferrer" class="nav-link external">
  我的博客
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>我的文档</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/my-docs/document/" class="sidebar-link">说明</a></li><li><a href="/my-docs/document/selenium-with-node.html" class="active sidebar-link">Selenium node.js中文文档</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/my-docs/document/selenium-with-node.html#什么是selenium" class="sidebar-link">什么是selenium</a></li><li class="sidebar-sub-header"><a href="/my-docs/document/selenium-with-node.html#搭建开发环境" class="sidebar-link">搭建开发环境</a></li><li class="sidebar-sub-header"><a href="/my-docs/document/selenium-with-node.html#安装和使用浏览器插件" class="sidebar-link">安装和使用浏览器插件</a></li><li class="sidebar-sub-header"><a href="/my-docs/document/selenium-with-node.html#第一个selenium脚本" class="sidebar-link">第一个selenium脚本</a></li><li class="sidebar-sub-header"><a href="/my-docs/document/selenium-with-node.html#常用api" class="sidebar-link">常用API</a></li></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="selenium-node-js中文文档"><a href="#selenium-node-js中文文档" class="header-anchor">#</a> Selenium node.js中文文档</h1> <h2 id="什么是selenium"><a href="#什么是selenium" class="header-anchor">#</a> 什么是selenium</h2> <p><strong>Selenium</strong>是一个用于Web应用程序测试的工具。Selenium测试直接运行在浏览器中，就像真正的用户在操作一样。支持的浏览器包括IE（7, 8, 9, 10, 11），Mozilla Firefox，Safari，Google Chrome，Opera等。这个工具的主要功能包括：测试与浏览器的兼容性——测试你的应用程序看是否能够很好得工作在不同浏览器和操作系统之上。测试系统功能——创建回归测试检验软件功能和用户需求。支持自动录制动作和自动生成 .Net、Java、Perl等不同语言的测试脚本。</p> <h2 id="搭建开发环境"><a href="#搭建开发环境" class="header-anchor">#</a> 搭建开发环境</h2> <ol><li>安装node.js</li> <li>npm init 根据提示创建一个node.js项目</li> <li>npm install selenium-webdriver –g 安装selenium-webdriver</li> <li>在项目中创建一个js文件，比如index.js，在里面写自动化测试脚本即可</li></ol> <h2 id="安装和使用浏览器插件"><a href="#安装和使用浏览器插件" class="header-anchor">#</a> 安装和使用浏览器插件</h2> <p>Selenium是一个中间层，它接收用户（selenium脚本）的操作指令，然后再通过浏览器的底层指令，告诉浏览器我们要做什么操作。所以就需要相应浏览器驱动的支持，浏览器驱动在windows环境中是.exe文件。</p> <p><a href="http://chromedriver.storage.googleapis.com/index.html" target="_blank" rel="noopener noreferrer">点我下载windows系统的chrome浏览器驱动<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>
根据自己当前浏览器版本，选择合适的驱动文件下载使用</p> <p>有以下三种使用方法：</p> <ol><li>将驱动文件和自动化测试脚本放在同一个目录下即可，如果集成了jest库，则将驱动文件放在根目录即可</li> <li>配置系统环境变量</li> <li>通过代码指定驱动路径</li></ol> <h2 id="第一个selenium脚本"><a href="#第一个selenium脚本" class="header-anchor">#</a> 第一个selenium脚本</h2> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> <span class="token punctuation">{</span> Builder <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'selenium-webdriver'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> driver <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Builder</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">.</span><span class="token function">forBrowser</span><span class="token punctuation">(</span><span class="token string">'chrome'</span><span class="token punctuation">)</span> <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">example</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 最大化屏幕</span>
    <span class="token keyword">await</span> driver<span class="token punctuation">.</span><span class="token function">manage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">window</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">maximize</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">await</span> driver<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'http://www.baidu.com'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token function">example</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>执行上面的脚本，可以执行以下步骤：</p> <ol><li>打开chrome浏览器</li> <li>最大化浏览器</li> <li>跳转到百度首页</li></ol> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>由于浏览器的操作都是异步的，且每个操作都有先后顺序，所以使用了es6的async/await语法。</p></div> <h2 id="常用api"><a href="#常用api" class="header-anchor">#</a> 常用API</h2> <h3 id="元素定位"><a href="#元素定位" class="header-anchor">#</a> 元素定位</h3> <ol><li>查找单个元素，使用<strong>findElement(元素位置)</strong>，返回一个webElement</li> <li>查找多个元素，使用<strong>findElements(元素位置)</strong>，返回一个webElement的list</li></ol> <p>通过浏览器的By对象中的方法，获得元素位置。 具体有以下几个方法：</p> <ul><li><strong>By.className(class)</strong>  通过类名获得元素位置</li> <li><strong>By.id(id)</strong>  通过id名获得元素位置</li> <li><strong>By.css(css selector)</strong>  通过css选择器获得元素位置，推荐使用</li> <li><strong>By.name(name value)</strong>  通过标签中名为name的attribute属性值来获得元素位置</li> <li><strong>By.linkText(text)</strong>  通过页面上超链接里的文本获得元素位置，比如新闻里的新闻</li> <li><strong>By.partialLinkText(text)</strong>  与linkText一样，但不用完全匹配，只用包含即可</li> <li><strong>By.js(script, var_args)</strong>  通过js脚本获得元素位置，script的执行结果必须是一个元素或者元素列表，var_args是需要传进脚本的参数</li> <li><strong>By.xpath(xpath)</strong>  通过xpath获得元素位置</li></ul> <p>示例如下：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">elementLocation</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 最大化屏幕</span>
    <span class="token keyword">await</span> driver<span class="token punctuation">.</span><span class="token function">manage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">window</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">maximize</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">await</span> driver<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'http://www.htmimi.com/index.aspx'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// By.className() 获取类名是nav的所有元素，返回一个webElement的list</span>
    <span class="token keyword">let</span> dom1 <span class="token operator">=</span> <span class="token keyword">await</span> driver<span class="token punctuation">.</span><span class="token function">findElements</span><span class="token punctuation">(</span>By<span class="token punctuation">.</span><span class="token function">className</span><span class="token punctuation">(</span><span class="token string">'nav'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// By.id() 返回id为app的元素</span>
    <span class="token keyword">let</span> dom2 <span class="token operator">=</span> <span class="token keyword">await</span> driver<span class="token punctuation">.</span><span class="token function">findElement</span><span class="token punctuation">(</span>By<span class="token punctuation">.</span><span class="token function">id</span><span class="token punctuation">(</span><span class="token string">'app'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// By.css() 返回类名为head-right的元素下，所有的a标签子元素</span>
    <span class="token keyword">let</span> dom3 <span class="token operator">=</span> <span class="token keyword">await</span> driver<span class="token punctuation">.</span><span class="token function">findElements</span><span class="token punctuation">(</span>By<span class="token punctuation">.</span><span class="token function">css</span><span class="token punctuation">(</span><span class="token string">'.head-right &gt; a'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// By.name() 返回标签中name属性值为tab1的第一个元素</span>
    <span class="token keyword">let</span> dom4 <span class="token operator">=</span> <span class="token keyword">await</span> driver<span class="token punctuation">.</span><span class="token function">findElement</span><span class="token punctuation">(</span>By<span class="token punctuation">.</span><span class="token function">name</span><span class="token punctuation">(</span><span class="token string">'tab1'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// By.linkText() 返回超链接中文本为&quot;首页&quot;的元素</span>
    <span class="token keyword">let</span> dom5 <span class="token operator">=</span> <span class="token keyword">await</span> driver<span class="token punctuation">.</span><span class="token function">findElement</span><span class="token punctuation">(</span>By<span class="token punctuation">.</span><span class="token function">linkText</span><span class="token punctuation">(</span><span class="token string">'首页'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// By.partialLinkText() 返回超链接文本中包含“我们”的所有元素</span>
    <span class="token keyword">let</span> dom6 <span class="token operator">=</span> <span class="token keyword">await</span> driver<span class="token punctuation">.</span><span class="token function">findElements</span><span class="token punctuation">(</span>By<span class="token punctuation">.</span><span class="token function">partialLinkText</span><span class="token punctuation">(</span><span class="token string">'我们'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// By.js 返回js脚本获取的元素 获取id为app的元素</span>
    <span class="token keyword">let</span> dom7 <span class="token operator">=</span> <span class="token keyword">await</span> driver<span class="token punctuation">.</span><span class="token function">findElement</span><span class="token punctuation">(</span>By<span class="token punctuation">.</span><span class="token function">js</span><span class="token punctuation">(</span><span class="token string">'document.getElementById(&quot;app&quot;)'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// By.xpath 通过xpath定位元素 获取类名为text-primary的span元素</span>
    <span class="token keyword">let</span> dom8 <span class="token operator">=</span> <span class="token keyword">await</span> driver<span class="token punctuation">.</span><span class="token function">findElements</span><span class="token punctuation">(</span>By<span class="token punctuation">.</span><span class="token function">xpath</span><span class="token punctuation">(</span><span class="token string">'//span[@class=&quot;text-primary&quot;]'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="获取属性值"><a href="#获取属性值" class="header-anchor">#</a> 获取属性值</h3> <ol><li><p>获取浏览器属性</p> <ul><li>获取页面源代码 driver.getPageSource();</li> <li>获取页面标题 driver.getTitle();</li> <li>获取当前页面URL driver.getCurrentUrl();</li></ul></li> <li><p>获取元素属性
这里的element，是通过findElements或者findElement获得的页面元素；</p> <ul><li>获取元素中没有隐藏的文字 element.getText();</li></ul> <div class="language-html extra-class"><pre class="language-html"><code>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>app<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span><span class="token punctuation">&gt;</span></span>哈哈<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span><span class="token punctuation">&gt;</span></span>我也是a<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>假如有如上的dom结构，通过findElement获取到外层div，调用getText()，若“哈哈”，“我也是”，都在可视区域，那么就会得到“哈哈 我也是”</p> <p>如果有一段文字特别长，有10行，在当前视口区域只显示了5行。那么调用getText()只能拿到前五行的内容</p></div> <ul><li>返回标签名称 element.getTagName();</li> <li>获取服务器给这个element分配的不透明Id element.getId();</li></ul> <div class="language-html extra-class"><pre class="language-html"><code>    类似1d287ebf-c353-4f21-a1d9-ce035eba88ce
</code></pre></div><ul><li>获取元素css值，必传参数，若不传返回空字符串 element.getCssValue(‘z-index’);</li> <li>获取元素属性值，必传参数，若不传会报错 element.getAttribute(‘class’);</li> <li>获取元素的宽高以及左上角的x，y坐标 element.getRect();</li></ul></li></ol> <h3 id="浏览器操作"><a href="#浏览器操作" class="header-anchor">#</a> 浏览器操作</h3> <ol><li>浏览器最大化<div class="language-javascript extra-class"><pre class="language-javascript"><code>   driver<span class="token punctuation">.</span><span class="token function">manage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">window</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">maximize</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></li> <li>览器最小化<div class="language-javascript extra-class"><pre class="language-javascript"><code>   driver<span class="token punctuation">.</span><span class="token function">manage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">window</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">minimize</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></li> <li>前进<div class="language-javascript extra-class"><pre class="language-javascript"><code>   driver<span class="token punctuation">.</span><span class="token function">navigate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forward</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div></li> <li>后退<div class="language-javascript extra-class"><pre class="language-javascript"><code>   driver<span class="token punctuation">.</span><span class="token function">navigate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">back</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div></li> <li>刷新页面<div class="language-javascript extra-class"><pre class="language-javascript"><code>   driver<span class="token punctuation">.</span><span class="token function">navigate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">refresh</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div></li> <li>跳转到<div class="language-javascript extra-class"><pre class="language-javascript"><code>   driver<span class="token punctuation">.</span><span class="token function">navigate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">to</span><span class="token punctuation">(</span><span class="token string">'http://www.baidu.com'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></li></ol></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/my-docs/document/" class="prev router-link-active">
        说明
      </a></span> <!----></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/my-docs/assets/js/app.3d81e2fe.js" defer></script><script src="/my-docs/assets/js/2.c5daa531.js" defer></script><script src="/my-docs/assets/js/11.9e365dcc.js" defer></script>
  </body>
</html>
